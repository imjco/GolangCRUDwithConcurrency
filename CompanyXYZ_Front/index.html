<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>XYZ Book</title>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">


</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<script type="text/javascript">
	$(document).ready(function(){
	// // Activate tooltip
	// $('[data-toggle="tooltip"]').tooltip();
	
	// // Select/Deselect checkboxes
	// var checkbox = $('table tbody input[type="checkbox"]');
	// $("#selectAll").click(function(){
	// 	if(this.checked){
	// 		checkbox.each(function(){
	// 			this.checked = true;                        
	// 		});
	// 	} else{
	// 		checkbox.each(function(){
	// 			this.checked = false;                        
	// 		});
	// 	} 
	// });
	// checkbox.click(function(){
	// 	if(!this.checked){
	// 		$("#selectAll").prop("checked", false);
	// 	}
	// });
    // async function loadIntoTable(url, table){
    //   const tableHead = table.querySelector('thead');
    //   const tableBody = table.querySelector('tbody');
    //   const response = await fetch(url);
    //   const {headers, rows}  = await response.json();
    //    tableHead.innerHTML = '';
    //     tableBody.innerHTML = '';

    //     // populate table head
    //     for (const headerText of headers){
    //       const header = document.createElement('th');

    //     }


    // }
      
});

</script>
  <body>
    <div class="container">
        <div class="table-wrapper">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-6">
						<h2>Manage <b>Books</b></h2>
					  </div>
					<div class="col-sm-6">
            <a href="#addBookModal" class="btn btn-success " style="border-radius: 20px;" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>Add New Book</span></a>
            <div class="search-box">
              <i class="material-icons">&#xE8B6;</i>
              <input type="text" id="myInput" class="form-control" on onkeydown="search()" placeholder="Search ISBN13" title="Type in a book">
            </div>
            
						
						<!-- <a href="#deleteEmployeeModal" class="btn btn-danger" data-toggle="modal"><i class="material-icons">&#xE15C;</i> <span>Delete</span></a>						 -->
					  </div>
                </div>
            </div>

						<div class="grid-container">
							<div class="item1">
								
									<label>ISBN-13 to ISBN-10</label>
									<input id="AFrom" type="numeric" placeholder="Enter your ISBN-13" maxlength="13" required >
									<input id="ATo" type="numeric"  readonly >
									<button type="button" class="btn btn-primary" onclick="convertIsbn13()">Convert to ISBN-10</button>

							</div>
							<div class="item2">
									<label>ISBN-10 to ISBN-13</label>
									<input id="BFrom" type="numeric" placeholder="Enter your ISBN-10" maxlength="10" required >
									<input id="BTo" type="numeric"  readonly >
									<button type="button" class="btn btn-primary" onclick="convertIsbn10()">Convert to ISBN-13</button>
							</div>
							
							
						</div>



						Show:
						<select name="pagesize" id="pagesize" onchange='changepagesize()'>
							<option value="10">10</option>
							<option value="20">20</option>
							<option value="50">50</option>
							<option value="100">100</option>
						</select>
						entries
            <table id="table" class="table table-striped table-hover">
              <thead>
                <tr>
                  <th scope="col">ID</th>
                  <th scope="col">Title</th>
                  <th scope="col">Author</th>
                  <th scope="col">ISBN13</th>
                  <th scope="col">ISBN10</th>
                  <th scope="col">Publication Year</th>
                  <th scope="col">Publisher</th>
                  <th scope="col">Edition</th>
                  <th scope="col">Price</th>
                  <th scope="col"></th>   
									<th scope="col">Actions</th>         
                </tr>
              </thead>
              <tbody id="table_body"> </tbody>
             </table>

						 <div class="grid-container">
							<div class="grid-item">
								

							</div>
							<div class="grid-item">
								<div class="clearfix">
									<div id="showingcount" class="hint-text">
										Showing <b>5</b> out of <b>25</b> entries
									</div>
									<ul class="pagination" id="myPagination">
											
									</ul>
							</div>


							</div>
						 </div>

        </div>

				
			
    </div>
		
	<!-- Add Modal HTML -->
	<div id="addBookModal" class="modal fade modal-xl">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">						
						<h4 class="modal-title">Add Book</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">				
            <div class="form-group">
						<!-- <label >ID</label> -->
						<input id="id" type="hidden"  class="form-control"  >
						</div>	
						<div class="form-group">
							<label>Title</label>
							<input id="title" type="text" class="form-control" >
						</div>
            <div class="form-group">
							<label>Author</label>
		

							<div>

							</div>
							<!-- <button type="button" onclick="appendToSelectedItems('Frederick Lopez',8)">append</button> -->
							<div class="multiselect-container">
								<input type="text" id="multiselect" class="multiselect-select" placeholder="Select Author">
								<div class="selected-items" id="selectedItems"></div>
								<ul id="dropdownItems" style="display: none;"></ul>
							</div>
					
						

						</div>
            <div class="form-group">
							<label>ISBN13</label>
							<input id="isbn13" type="text" class="form-control" >
						</div>
            <div class="form-group">
							<label>ISBN10</label>
							<input id="isbn10" type="text" class="form-control" >
						</div>
            <div class="form-group">
							<label>Publication Year</label>
							<input id="publicationyear" class="form-control" type="number" min="1920" max="2023" step="1"  />
						</div>
            <div class="form-group">
							<label>Publisher</label>
							<div></div>
							<!-- <input id="publisher" type="text" class="form-control" required> -->
							<div class="multiselect-container">
								<input type="text" id="multiselect_p" class="multiselect-select_p" placeholder="Select Publisher">
								<div class="selected-items" id="selectedItems_p"></div>
								<ul id="dropdownItems_p" style="display: none;"></ul>
							</div>
						</div>
            <div class="form-group">
							<label>Edition</label>
							<input id="edition" type="text" class="form-control" >
						</div>
            <div class="form-group">
							<label>Price</label>
							<input id="price" class="form-control" type="number" min="0" max="99999999" step="1"  />
						</div>
										
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<!-- <input type="submit" class="btn btn-success" value="Add" onclick="addbook()"> -->
						<input type="submit" class="btn btn-success" value="Add" onclick="addbook()">
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- Edit Modal HTML -->
	<div id="editBookModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">						
						<h4 class="modal-title">Edit Book</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">				
            <div class="form-group">
							<!-- <label >ID</label> -->
							<input id="id_e" type="hidden"  class="form-control" required >
						</div>	
						<div class="form-group">
							<label>Title</label>
							<input id="title_e" type="text" class="form-control" required>
						</div>
            <label>Author</label>
							<div></div>
							<!-- <button type="button" onclick="appendToSelectedItems_UpdateAuthor('Frederick Lopez',8)">append</button> -->
							<div class="multiselect-container">
								<input type="text" id="multiselect_u_a" class="multiselect-select" placeholder="Select Author">
								<div class="selected-items" id="selectedItems_u_a"></div>
								<ul id="dropdownItems_u_a" style="display: none;"></ul>
							</div>
            <div class="form-group">
							<label>ISBN13</label>
							<input id="isbn13_e" type="text" class="form-control" required>
						</div>
            <div class="form-group">
							<label>ISBN10</label>
							<input id="isbn10_e" type="text" class="form-control">
						</div>
            <div class="form-group">
							<label>Publication Year</label>
							<input id="publicationyear_e" class="form-control" type="number" min="1920" max="2023" step="1" required />
							<!-- <input id="publicationyear_e" type="text" class="form-control" required> -->
						</div>
             <div class="form-group">
							<label>Publisher</label>
							<div></div>
							<!-- <input id="publisher" type="text" class="form-control" required> -->
							<div class="multiselect-container">
								<input type="text" id="multiselect_u_p" class="multiselect-select_u_p" placeholder="Select Publisher">
								<div class="selected-items" id="selectedItems_u_p"></div>
								<ul id="dropdownItems_u_p" style="display: none;"></ul>
							</div>
						</div> 
            <div class="form-group">
							<label>Edition</label>
							<input id="edition_e" type="text" class="form-control">
						</div>
            <div class="form-group">
							<label>Price</label>
							<input id="price_e" class="form-control" type="number" min="0" max="99999999" step="1"  required/>
							
						</div>
										
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-info" value="Update" onclick="updatebook()">
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- Delete Modal HTML -->
	<div id="deleteBookModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">						
						<h4 class="modal-title">Delete Book?</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">					
						<p>Are you sure you want to delete these Record?</p>
						<p id="deletetitle"></p>
						<p class="text-warning"><small>This action cannot be undone.</small></p>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-danger" value="Delete" onclick="deleteBook()">
					</div>
				</form>
			</div>
		</div>
	</div>
</body>
<script src="APIURL.js"></script>
<script>

 const multiselect = document.getElementById("multiselect");
 const dropdownItems = document.getElementById("dropdownItems");
 const selectedItems = document.getElementById("selectedItems");


 // Store selected items and their IDs
 const selectedData = [];

 multiselect.addEventListener("focus", function () {
	 dropdownItems.style.display = "block";
 });

 multiselect.addEventListener("blur", function () {
	 // Use a setTimeout to allow clicking on items before hiding the dropdown
	 setTimeout(() => {
		 dropdownItems.style.display = "none";
	 }, 200);
 });

multiselect.addEventListener("input", function () {
  const filter = multiselect.value.toLowerCase();
  const items = dropdownItems.getElementsByTagName("li");

  for (let i = 0; i < items.length; i++) {
    const item = items[i];
    const text = item.textContent.toLowerCase();
    const itemId = item.getAttribute("data-id");

    // Check if the item is already in the selectedItems div
    const isItemSelected = selectedData.some((selected) => selected.id === itemId);

    if (text.includes(filter) && !isItemSelected) {
      item.style.display = "block";
    } else {
      item.style.display = "none";
    }
  }
});
dropdownItems.addEventListener("click", function (event) {
	 if (event.target.tagName === "LI") {
		 const selectedItem = document.createElement("div");
		 selectedItem.textContent = event.target.textContent;
		 selectedItem.classList.add("list-item");

		 const removeButton = document.createElement("span");
		 removeButton.textContent = "x";
		 removeButton.classList.add("remove-item");
		 removeButton.addEventListener("click", function () {
			 selectedItems.removeChild(selectedItem);
			 event.target.style.display = "block";
			 // Remove the item and its ID from the selectedData array
			 const itemIndex = selectedData.findIndex((data) => data.text === selectedItem.textContent);
			 if (itemIndex !== -1) {
				 selectedData.splice(itemIndex, 1);
			 }
		 });

		 selectedItem.appendChild(removeButton);
		 selectedItems.appendChild(selectedItem);

		 multiselect.value = "";
		// multiselect.focus();
		 event.target.style.display = "none";

		 // Store the selected item and its ID in selectedData array
		 selectedData.push({
			 text: selectedItem.textContent,
			 id: event.target.getAttribute("data-id"), // Add a "data-id" attribute to your <li> elements with the item ID
		 });
	 }
 });

	fetch(apiUrl +"/authors?page=1&limit=100")
	 .then((response) => response.json())
	 .then((data) => {
		 const itemsList = document.getElementById("dropdownItems");

		 // Loop through the data and create list items for each option
		 data.forEach((item) => {
			 const listItem = document.createElement("li");
			 listItem.textContent = item.FirstName + " " + item.LastName; // Adjust this to match your JSON structure
			 listItem.setAttribute("data-id", item.ID); // Add a "data-id" attribute with the item ID
			 itemsList.appendChild(listItem);
		 });
	 })
	 .catch((error) => console.error("Error fetching data:", error));

 // Function to append the selected item to the selectedItems div
 function appendToSelectedItems(itemText, itemId) {
    const selectedItem = document.createElement("div");
    selectedItem.textContent = itemText;
    selectedItem.classList.add("list-item");

    const removeButton = document.createElement("span");
    removeButton.textContent = "x";
    removeButton.classList.add("remove-item");
    removeButton.addEventListener("click", function () {
      selectedItems.removeChild(selectedItem);
      // Remove the item and its ID from the selectedData array
      const itemIndex = selectedData.findIndex(
        (data) => data.text === itemText
      );
      if (itemIndex !== -1) {
        selectedData.splice(itemIndex, 1);
      }

      // Re-enable the selected item in the dropdown
      const dropdownItem = document.createElement("li");
      dropdownItem.textContent = itemText;
      dropdownItem.setAttribute("data-id", itemId);
      dropdownItem.addEventListener("click", function () {
        const itemText = dropdownItem.textContent;
        const itemId = dropdownItem.getAttribute("data-id");
        multiselect.value = "";
        multiselect.focus();

        // Call the function to append the selected item to the selectedItems div
       // appendToSelectedItems(itemText, itemId);
        dropdownItems.removeChild(dropdownItem);
      });

      dropdownItems.appendChild(dropdownItem);
    });

    selectedItem.appendChild(removeButton);
    selectedItems.appendChild(selectedItem);

    // Store the selected item and its ID in selectedData array
    selectedData.push({
      text: itemText,
      id: itemId,
    });

    // Remove the selected item from the dropdown
    const dropdownItem = document.querySelector(`li[data-id="${itemId}"]`);
    if (dropdownItem) {
      dropdownItems.removeChild(dropdownItem);
    }
  }

function clearSelectedItems() {
  // Clear the selectedItems div
  selectedItems.innerHTML = '';

  // Reset the visibility of items in the dropdown
  const items = dropdownItems.getElementsByTagName("li");
  for (let i = 0; i < items.length; i++) {
    const item = items[i];
    const itemId = item.getAttribute("data-id");

    // Check if the item is already in the selectedItems div
    const isItemSelected = selectedData.some((selected) => selected.id === itemId);

    if (!isItemSelected) {
      item.style.display = "block";
    }
  }

  // Clear the selectedData array
  selectedData.length = 0;
}



		// ========================= Publisher =========================
		const multiselect_p = document.getElementById("multiselect_p");
		const dropdownItems_p = document.getElementById("dropdownItems_p");
		const selectedItems_p = document.getElementById("selectedItems_p");
		const selectedData_p = [];
		multiselect_p.addEventListener("focus", function () {
			dropdownItems_p.style.display = "block";
		});
		multiselect_p.addEventListener("blur", function () {
			// Use a setTimeout to allow clicking on items before hiding the dropdown
			setTimeout(() => {
				dropdownItems_p.style.display = "none";
			}, 200);
		});
		multiselect_p.addEventListener("input", function () {
			const filter = multiselect_p.value.toLowerCase();
			const items = dropdownItems_p.getElementsByTagName("li");
			for (let i = 0; i < items.length; i++) {
				const item = items[i];
				const text = item.textContent.toLowerCase();
				const itemId = item.getAttribute("data-id");
				// Check if the item is already in the selectedItems div
				const isItemSelected = selectedData_p.some(
					(selected) => selected.id === itemId
				);
				if (text.includes(filter) && !isItemSelected) {
					item.style.display = "block";
				} else {
					item.style.display = "none";
				}
			}
		});
		dropdownItems_p.addEventListener("click", function (event) {
			if (event.target.tagName === "LI") {
				const selectedItem = document.createElement("div");
				selectedItem.textContent = event.target.textContent;
				selectedItem.classList.add("list-item");
				const removeButton = document.createElement("span");
				removeButton.textContent = "x";
				removeButton.classList.add("remove-item");
				removeButton.addEventListener("click", function () {
					selectedItems_p.removeChild(selectedItem);
					event.target.style.display = "block";
					// Remove the item and its ID from the selectedData array
					const itemIndex = selectedData_p.findIndex(
						(data) => data.text === selectedItem.textContent
					);
					if (itemIndex !== -1) {
						selectedData_p.splice(itemIndex, 1);
					}
				});
				selectedItem.appendChild(removeButton);
				selectedItems_p.appendChild(selectedItem);
				multiselect_p.value = "";
				// multiselect.focus();
				event.target.style.display = "none";
				// Store the selected item and its ID in selectedData array
				selectedData_p.push({
					text: selectedItem.textContent,
					id: event.target.getAttribute("data-id"), // Add a "data-id" attribute to your <li> elements with the item ID
				});
			}
		});
		fetch(apiUrl +"/publishers?page=1&limit=100")
			.then((response) => response.json())
			.then((data) => {
				const itemsList = document.getElementById("dropdownItems_p");
				// Loop through the data and create list items for each option
				data.forEach((item) => {
					const listItem = document.createElement("li");
					listItem.textContent = item.Name; // Adjust this to match your JSON structure
					listItem.setAttribute("data-id", item.ID); // Add a "data-id" attribute with the item ID
					itemsList.appendChild(listItem);
				});
			})
			.catch((error) => console.error("Error fetching data:", error));
		// Function to append the selected item to the selectedItems div
		function appendToSelectedItems_p(itemText, itemId) {
			const selectedItem = document.createElement("div");
			selectedItem.textContent = itemText;
			selectedItem.classList.add("list-item");
			const removeButton = document.createElement("span");
			removeButton.textContent = "x";
			removeButton.classList.add("remove-item");
			removeButton.addEventListener("click", function () {
				selectedItems_p.removeChild(selectedItem);
				// Remove the item and its ID from the selectedData array
				const itemIndex = selectedData_p.findIndex(
					(data) => data.text === itemText
				);
				if (itemIndex !== -1) {
					selectedData_p.splice(itemIndex, 1);
				}
				// Re-enable the selected item in the dropdown
				const dropdownItem = document.createElement("li");
				dropdownItem.textContent = itemText;
				dropdownItem.setAttribute("data-id", itemId);
				dropdownItem.addEventListener("click", function () {
					const itemText = dropdownItem.textContent;
					const itemId = dropdownItem.getAttribute("data-id");
					multiselect_p.value = "";
					multiselect_p.focus();
					// Call the function to append the selected item to the selectedItems div
					// appendToSelectedItems(itemText, itemId);
					dropdownItems_p.removeChild(dropdownItem);
				});
				dropdownItems_p.appendChild(dropdownItem);
			});
			selectedItem.appendChild(removeButton);
			selectedItems_p.appendChild(selectedItem);
			// Store the selected item and its ID in selectedData array
			selectedData_p.push({
				text: itemText,
				id: itemId,
			});
			// Remove the selected item from the dropdown
			const dropdownItem = document.querySelector(`li[data-id="${itemId}"]`);
			if (dropdownItem) {
				dropdownItems_p.removeChild(dropdownItem);
			}
		}
		

		function clearAddBookModal() {
    // Clear input fields

		multiselect.innerHTML = '';
		selectedItems.innerHTML = '';

		multiselect_p.innerHTML = '';
		selectedItems_p.innerHTML = '';

    document.getElementById("title").value = "";
    document.getElementById("isbn13").value = "";
    document.getElementById("isbn10").value = "";
    document.getElementById("publicationyear").value = "";
    document.getElementById("edition").value = "";
    document.getElementById("price").value = "";

   
}
		//======================= Update Modal Author =====================================

		const multiselect_u_a = document.getElementById("multiselect_u_a");
		let dropdownItems_u_a = document.getElementById("dropdownItems_u_a");
		const selectedItems_u_a = document.getElementById("selectedItems_u_a");
		const selectedData_u_a = [];
		multiselect_u_a.addEventListener("focus", function () {
			dropdownItems_u_a.style.display = "block";
		});
		multiselect_u_a.addEventListener("blur", function () {
			// Use a setTimeout to allow clicking on items before hiding the dropdown
			setTimeout(() => {
				dropdownItems_u_a.style.display = "none";
			}, 200);
		});
		multiselect_u_a.addEventListener("input", function () {
	
			const filter = multiselect_u_a.value.toLowerCase();
			const items = dropdownItems_u_a.getElementsByTagName("li");
			for (let i = 0; i < items.length; i++) {
				const item = items[i];
				const text = item.textContent.toLowerCase();
				const itemId = item.getAttribute("data-id");
				// Check if the item is already in the selectedItems div
				const isItemSelected = selectedData_u_a.some(
					(selected) => selected.id === itemId
				);
				if (text.includes(filter) && !isItemSelected) {
					item.style.display = "block";
				} else {
					item.style.display = "none";
				}
			}
		});
		dropdownItems_u_a.addEventListener("click", function (event) {
			
			if (event.target.tagName === "LI") {
				const selectedItem = document.createElement("div");
				selectedItem.textContent = event.target.textContent;
				selectedItem.classList.add("list-item");
				const removeButton = document.createElement("span");
				removeButton.textContent = "x";
				removeButton.classList.add("remove-item");
				removeButton.addEventListener("click", function () {
					selectedItems_u_a.removeChild(selectedItem);
					event.target.style.display = "block";
					// Remove the item and its ID from the selectedData array
					const itemIndex = selectedData_u_a.findIndex(
						(data) => data.text === selectedItem.textContent
					);
					if (itemIndex !== -1) {
						selectedData_u_a.splice(itemIndex, 1);
					}
				});
				selectedItem.appendChild(removeButton);
				selectedItems_u_a.appendChild(selectedItem);
				multiselect_u_a.value = "";
				// multiselect.focus();
				event.target.style.display = "none";
				// Store the selected item and its ID in selectedData array
				console.log(event.target.getAttribute("data-id"))
				selectedData_u_a.push({
					text: selectedItem.textContent,
					id: event.target.getAttribute("data-id"), // Add a "data-id" attribute to your <li> elements with the item ID
				});
			}
		});
		fetch(apiUrl +"/authors?page=1&limit=100")
	 .then((response) => response.json())
	 .then((data) => {
		 const itemsList = document.getElementById("dropdownItems_u_a");

		 // Loop through the data and create list items for each option
		 data.forEach((item) => {
			 const listItem = document.createElement("li");
			 listItem.textContent = item.FirstName + " " + item.LastName; // Adjust this to match your JSON structure
			 listItem.setAttribute("data-id", item.ID); // Add a "data-id" attribute with the item ID
			 itemsList.appendChild(listItem);
		 });
		
	 })
	 .catch((error) => console.error("Error fetching data:", error));
		// Function to append the selected item to the selectedItems div
		
		function appendToSelectedItems_UpdateAuthor(itemText, itemId) {

			const selectedItem = document.createElement("div");
			selectedItem.textContent = itemText;
			selectedItem.classList.add("list-item");
			const removeButton = document.createElement("span");
			removeButton.textContent = "x";
			removeButton.classList.add("remove-item");
			removeButton.addEventListener("click", function () {
				selectedItems_u_a.removeChild(selectedItem);
				// Remove the item and its ID from the selectedData array
				const itemIndex = selectedData_u_a.findIndex(
					(data) => data.text === itemText
				);
				if (itemIndex !== -1) {
					selectedData_u_a.splice(itemIndex, 1);
				}
				// Re-enable the selected item in the dropdown
				const dropdownItem = document.createElement("li");
				dropdownItem.textContent = itemText;
				dropdownItem.setAttribute("data-id", itemId);
				dropdownItem.addEventListener("click", function () {
					const itemText = dropdownItem.textContent;
					const itemId = dropdownItem.getAttribute("data-id");
					multiselect_u_a.value = "";
					multiselect_u_a.focus();
					
					dropdownItems_u_a.removeChild(dropdownItem);
				});
				dropdownItems_u_a.appendChild(dropdownItem);
			});
			selectedItem.appendChild(removeButton);
			selectedItems_u_a.appendChild(selectedItem);
			// Store the selected item and its ID in selectedData array
			selectedData_u_a.push({
				text: itemText,
				id: itemId,
			});
		
			// Remove the selected item from the dropdown
			const dropdownItem = document.querySelector(`li[data-id="${itemId}"]`);
		
				// if (dropdownItem) {
				// dropdownItems_u_a.removeChild(dropdownItem);
				// }
		
		}
		//======================= Update Modal Publisher =====================================


		const multiselect_u_p = document.getElementById("multiselect_u_p");
		let dropdownItems_u_p = document.getElementById("dropdownItems_u_p");
		const selectedItems_u_p = document.getElementById("selectedItems_u_p");
		const selectedData_u_p = [];
		multiselect_u_p.addEventListener("focus", function () {
			dropdownItems_u_p.style.display = "block";
		});
		multiselect_u_p.addEventListener("blur", function () {
			// Use a setTimeout to allow clicking on items before hiding the dropdown
			setTimeout(() => {
				dropdownItems_u_p.style.display = "none";
			}, 200);
		});
		multiselect_u_p.addEventListener("input", function () {
	
			const filter = multiselect_u_p.value.toLowerCase();
			const items = dropdownItems_u_p.getElementsByTagName("li");
			for (let i = 0; i < items.length; i++) {
				const item = items[i];
				const text = item.textContent.toLowerCase();
				const itemId = item.getAttribute("data-id");
				// Check if the item is already in the selectedItems div
				const isItemSelected = selectedData_u_p.some(
					(selected) => selected.id === itemId
				);
				if (text.includes(filter) && !isItemSelected) {
					item.style.display = "block";
				} else {
					item.style.display = "none";
				}
			}
		});
		dropdownItems_u_p.addEventListener("click", function (event) {
			
			if (event.target.tagName === "LI") {
				const selectedItem = document.createElement("div");
				selectedItem.textContent = event.target.textContent;
				selectedItem.classList.add("list-item");
				const removeButton = document.createElement("span");
				removeButton.textContent = "x";
				removeButton.classList.add("remove-item");
				removeButton.addEventListener("click", function () {
					selectedItems_u_p.removeChild(selectedItem);
					event.target.style.display = "block";
					// Remove the item and its ID from the selectedData array
					const itemIndex = selectedData_u_p.findIndex(
						(data) => data.text === selectedItem.textContent
					);
					if (itemIndex !== -1) {
						selectedData_u_p.splice(itemIndex, 1);
					}
				});
				selectedItem.appendChild(removeButton);
				selectedItems_u_p.appendChild(selectedItem);
				multiselect_u_p.value = "";
				// multiselect.focus();
				event.target.style.display = "none";
				// Store the selected item and its ID in selectedData array
				selectedData_u_p.push({
					text: selectedItem.textContent,
					id: event.target.getAttribute("data-id"), // Add a "data-id" attribute to your <li> elements with the item ID
				});
			}
		});
		fetch(apiUrl +"/publishers?page=1&limit=100")
	 .then((response) => response.json())
	 .then((data) => {
		 const itemsList = document.getElementById("dropdownItems_u_p");

		 // Loop through the data and create list items for each option
		 data.forEach((item) => {
			 const listItem = document.createElement("li");
			 listItem.textContent = item.Name; // Adjust this to match your JSON structure
			 listItem.setAttribute("data-id", item.ID); // Add a "data-id" attribute with the item ID
			 itemsList.appendChild(listItem);
		 });
		
	 })
	 .catch((error) => console.error("Error fetching data:", error));
		// Function to append the selected item to the selectedItems div
		
		function appendToSelectedItems_UpdatePublisher(itemText, itemId) {

			const selectedItem = document.createElement("div");
			selectedItem.textContent = itemText;
			selectedItem.classList.add("list-item");
			const removeButton = document.createElement("span");
			removeButton.textContent = "x";
			removeButton.classList.add("remove-item");
			removeButton.addEventListener("click", function () {
				selectedItems_u_p.removeChild(selectedItem);
				// Remove the item and its ID from the selectedData array
				const itemIndex = selectedData_u_p.findIndex(
					(data) => data.text === itemText
				);
				if (itemIndex !== -1) {
					selectedData_u_p.splice(itemIndex, 1);
				}
				// Re-enable the selected item in the dropdown
				const dropdownItem = document.createElement("li");
				dropdownItem.textContent = itemText;
				dropdownItem.setAttribute("data-id", itemId);
				dropdownItem.addEventListener("click", function () {
					const itemText = dropdownItem.textContent;
					const itemId = dropdownItem.getAttribute("data-id");
					multiselect_u_p.value = "";
					multiselect_u_p.focus();
					
					dropdownItems_u_p.removeChild(dropdownItem);
				});
				dropdownItems_u_p.appendChild(dropdownItem);
			});
			selectedItem.appendChild(removeButton);
			selectedItems_u_p.appendChild(selectedItem);
			// Store the selected item and its ID in selectedData array
			selectedData_u_p.push({
				text: itemText,
				id: itemId,
			});
		
			// Remove the selected item from the dropdown
			const dropdownItem = document.querySelector(`li[data-id="${itemId}"]`);
		
				// if (dropdownItem) {
				// dropdownItems_u_a.removeChild(dropdownItem);
				// }
		
				}




</script>
<script src="script.js"></script>
</html>